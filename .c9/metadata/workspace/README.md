{"filter":false,"title":"README.md","tooltip":"/README.md","undoManager":{"mark":100,"position":100,"stack":[[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":21,"column":0},"end":{"row":22,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":0},"end":{"row":23,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":0},"end":{"row":22,"column":1}},"text":"#"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":1},"end":{"row":22,"column":2}},"text":"#"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":2},"end":{"row":22,"column":3}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":3},"end":{"row":22,"column":4}},"text":"P"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":4},"end":{"row":22,"column":5}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":5},"end":{"row":22,"column":6}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":6},"end":{"row":22,"column":7}},"text":"v"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":22,"column":3},"end":{"row":22,"column":7}},"text":"Prov"},{"action":"insertText","range":{"start":{"row":22,"column":3},"end":{"row":22,"column":15}},"text":"Provisioning"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":15},"end":{"row":23,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":0},"end":{"row":24,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":24,"column":1}},"text":"*"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":1},"end":{"row":24,"column":2}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":2},"end":{"row":24,"column":40}},"text":"https://github.com/fideloper/Vaprobash"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":24,"column":2},"end":{"row":24,"column":40}},"text":"https://github.com/fideloper/Vaprobash"},{"action":"insertText","range":{"start":{"row":24,"column":2},"end":{"row":24,"column":3}},"text":"["}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":3},"end":{"row":24,"column":4}},"text":"]"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":4},"end":{"row":24,"column":5}},"text":"("}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":5},"end":{"row":24,"column":6}},"text":")"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":5},"end":{"row":24,"column":52}},"text":"http://fideloper.github.io/Vaprobash/index.html"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":3},"end":{"row":24,"column":12}},"text":"Vaprobash"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":62},"end":{"row":24,"column":63}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":63},"end":{"row":24,"column":64}},"text":"-"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":64},"end":{"row":24,"column":65}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":65},"end":{"row":24,"column":98}},"text":"Vagrant Provisioning Bash Scripts"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":44,"column":0},"end":{"row":45,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":0},"end":{"row":24,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":24,"column":1}},"text":"*"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":1},"end":{"row":24,"column":2}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":2},"end":{"row":24,"column":3}},"text":"["}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":3},"end":{"row":24,"column":4}},"text":"]"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":4},"end":{"row":24,"column":5}},"text":"("}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":5},"end":{"row":24,"column":6}},"text":")"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":5},"end":{"row":24,"column":58}},"text":"https://docs.vagrantup.com/v2/provisioning/index.html"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":3},"end":{"row":24,"column":4}},"text":"A"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":4},"end":{"row":24,"column":5}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":5},"end":{"row":24,"column":6}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":6},"end":{"row":24,"column":7}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":7},"end":{"row":24,"column":8}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":8},"end":{"row":24,"column":9}},"text":"v"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":9},"end":{"row":24,"column":10}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":10},"end":{"row":24,"column":11}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":11},"end":{"row":24,"column":12}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":12},"end":{"row":24,"column":13}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":13},"end":{"row":24,"column":14}},"text":"b"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":14},"end":{"row":24,"column":15}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":15},"end":{"row":24,"column":16}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":16},"end":{"row":24,"column":17}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":17},"end":{"row":24,"column":18}},"text":"b"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":18},"end":{"row":24,"column":19}},"text":"u"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":19},"end":{"row":24,"column":20}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":20},"end":{"row":24,"column":21}},"text":"l"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":21},"end":{"row":24,"column":22}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":22},"end":{"row":24,"column":23}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":23},"end":{"row":24,"column":24}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":24},"end":{"row":24,"column":25}},"text":"n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":25},"end":{"row":24,"column":26}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":26},"end":{"row":24,"column":27}},"text":"p"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":27},"end":{"row":24,"column":28}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":28},"end":{"row":24,"column":29}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":29},"end":{"row":24,"column":30}},"text":"v"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":24,"column":26},"end":{"row":24,"column":30}},"text":"prov"},{"action":"insertText","range":{"start":{"row":24,"column":26},"end":{"row":24,"column":38}},"text":"provisioning"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":38},"end":{"row":24,"column":39}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":39},"end":{"row":24,"column":40}},"text":"p"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":40},"end":{"row":24,"column":41}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":41},"end":{"row":24,"column":42}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":42},"end":{"row":24,"column":43}},"text":"v"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":43},"end":{"row":24,"column":44}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":44},"end":{"row":24,"column":45}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":45},"end":{"row":24,"column":46}},"text":"e"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":46},"end":{"row":24,"column":47}},"text":"r"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":47},"end":{"row":24,"column":48}},"text":"s"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":104},"end":{"row":24,"column":105}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":105},"end":{"row":24,"column":106}},"text":"-"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":106},"end":{"row":24,"column":107}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":107},"end":{"row":24,"column":108}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":108},"end":{"row":24,"column":109}},"text":"f"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":109},"end":{"row":24,"column":110}},"text":"f"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":110},"end":{"row":24,"column":111}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":111},"end":{"row":24,"column":112}},"text":"c"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":112},"end":{"row":24,"column":113}},"text":"i"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":113},"end":{"row":24,"column":114}},"text":"a"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":24,"column":107},"end":{"row":24,"column":114}},"text":"officia"},{"action":"insertText","range":{"start":{"row":24,"column":107},"end":{"row":24,"column":115}},"text":"official"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":115},"end":{"row":24,"column":116}},"text":" "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":116},"end":{"row":24,"column":117}},"text":"d"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":117},"end":{"row":24,"column":118}},"text":"o"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":118},"end":{"row":24,"column":119}},"text":"c"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":0},"end":{"row":24,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":25,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":24,"column":1}},"text":"*"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":1},"end":{"row":24,"column":2}},"text":"*"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":28,"column":0},"end":{"row":29,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":10,"column":0},"end":{"row":11,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":0},"end":{"row":23,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":4,"column":0},"end":{"row":5,"column":0}},"text":"\n"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":27,"column":0},"end":{"row":27,"column":2}},"text":"**"},{"action":"removeLines","range":{"start":{"row":26,"column":0},"end":{"row":27,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":26,"column":0},"end":{"row":27,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":215,"column":0},"end":{"row":215,"column":9}},"text":"</center>"},{"action":"removeLines","range":{"start":{"row":77,"column":0},"end":{"row":215,"column":0}},"nl":"\n","lines":["","","","## Provisioning","","Fine, now you have fresh Box deployed and running, you are ssh connected to it. You are free to install any software you need and go ahead.","> But wait - how can you share your server soft setup and provision to other collaborators then?","","You need an automated provisioning for it. Vagrant supports a lot of them :","","* Shell","* Ansible","* Chef","* Puppet","","As for Ansible, Chef and Puppet - you need to investigate it separately as they are good and you should definitely use them for \"serious\" production provisioning.","But now pure \"shell\" is our \"quick\" way ! Just add such line to Vagrantfile","~~~","config.vm.provision \"shell\", path: \"./setup.sh\"","~~~","and put `setup.sh` to folder near Vagrantfile, put there any valid OS-specific commands (as in ordinary shell script, it wil be run inside your Box), for example","~~~","#! /bin/bash","sudo apt-get update","echo mysql-server mysql-server/root_password password root | sudo debconf-set-selections","echo mysql-server mysql-server/root_password_again password root | sudo debconf-set-selections","sudo apt-get install -y git-core curl wget mc build-essential python-software-properties","sudo apt-get install -y apache2","sudo apt-get install -y mysql-server mysql-client","sudo apt-get install -y php5 libapache2-mod-php5 php5-cli php5-mysql php5-curl php5-gd php5-mcrypt php5-xdebug","~~~","to ensure your machine is properly provisioned you need to call","~~~","$ vagrant provision","~~~","and you know what? When it will finish you will have a machine with very basic LAMP installed.","","> For a Shell provisioning in Ubuntu I have found useful [repo with a set of apt-get install commands - Vaprobash](https://github.com/fideloper/Vaprobash). It is kept as \"modular\" and configurable files. Useful for quick and dirty Ubuntu server provisioning.","Also nice example for a Shell provisioning script is in [varying-vagrant-vagrants](https://github.com/10up/varying-vagrant-vagrants/blob/master/provision/provision.sh) repo","","<div class='bs-callout bs-callout-warning' markdown=\"1\">","One simple rule - install software manually inside Vagrant box only for your personal exeriments. If you plan to share Vagrantfile with others - provision all you software automatically and always remember to check \"fresh\" `vagrant up` from time to time. As if you will forget to specify some provisioning rules - another people or even you on other machine will not be able to run it seamlessly.","</div>","","## Folder sharing and synchronization","By default you can find out that in vagrant box you see `/vagrant` folder and it is the same folder where your Vagrantfile on **host** machine is located.","This folder is `shared` between host and Vagrant by means of VirtualBox \"shared folders\" feature.","You can specify your own set of shared folders like :","`config.vm.synced_folder \"./\", \"/var/www\"`","","This feature allows you to store project files on host machine and edit them with your IDE locally on host machine - but it will automatically be available on Vagrant machine, so you will run code and test on Vagrant machine.","","### NFS","If you have low performance of shared folder in VirtualBox machine you can try to use NFS sharing type (instead default one). Install NFS package","`sudo apt-get install nfs-kernel-server `","and modify Vagrantfile","`config.vm.synced_folder \"./\", \"/var/www\", type: \"nfs\"`","(but this sharing will not work on Windows host)","","### rsync","On big shared folder native sharing is really slow and NFS could work also not very fast, then you can try to use `rsync` sharing. It will not make any \"sharing\" of directory, byt \"sync\". So VM disk will work very fast (compared to sharing), but will require 2-3 sec. after changes made - to be synced in VM.","`config.vm.synced_folder \"./\", \"/var/www\", type: \"rsync\"`","then in Vagrantfile folder you need to run rsync watcher","`vagrant rsync-auto`","","<div class='bs-callout bs-callout-danger'>","When you delete files in Vagrant machine it is also deleted on host - your real PC.","So be carefull when sharing host system root folder and making \"rm / -Rf\" on Vagrant ;)","</div>","","## Network and port forwarding","This feature actually allows you to make network interactions between host and Vagrant machine.","To access guest machine via this IP from your host machine","~~~","config.vm.network \"private_network\", ip: \"192.168.77.77\"","~~~","To access guest machine's port 81 via http://localhost:8081 on host machine","~~~","config.vm.network :forwarded_port, guest: 81, host: 8081","~~~","You can combine these settings and proxy as many ports as you want.","","## Change VM settings","You can set non-default Virtual machine settings for VirtualBox in such way","~~~","config.vm.provider :virtualbox do |vb|","        vb.customize [\"modifyvm\", :id, \"--memory\", \"1024\"]","end","~~~","Complete list of all available params could be found on [VirtualBox site](http://www.virtualbox.org/manual/ch08.html#vboxmanage-modifyvm)","","**Tip** : Set a VirtualBox guest CPU count to the number of host cores","~~~","vb.customize [\"modifyvm\", :id, \"--cpus\", `grep \"^processor\" /proc/cpuinfo | wc -l`.chomp ]","~~~","","## Common Vagrant commands","","* `vagrant up` start machine","* `vagrant halt` stop machine (yes it is not `down` :))","* `vagrant reload` reload machine","* `vagrant destroy` remove/delete machine","* `vagrant ssh` connect via ssh to machine","* `vagrant provision` run provisioning stage on the machine, useful after changes in provisioning configs","","## Automatic VM resources setup","","Give VM 1/4 system memory and access to all cpu cores on the host","~~~{.ruby}","config.vm.provider \"virtualbox\" do |v|","  host = RbConfig::CONFIG['host_os']","","if host =~ /darwin/","    cpus = `sysctl -n hw.ncpu`.to_i","    mem = `sysctl -n hw.memsize`.to_i / 1024 / 1024 / 4","  elsif host =~ /linux/","    cpus = `nproc`.to_i","    mem = `grep 'MemTotal' /proc/meminfo | sed -e 's/MemTotal://' -e 's/ kB//'`.to_i / 1024 / 4","  else","    cpus = 2","    mem = 1024","  end","","  v.customize [\"modifyvm\", :id, \"--memory\", mem]","  v.customize [\"modifyvm\", :id, \"--cpus\", cpus]","end","~~~","","## Useful plugins","","Cool things are not finished yet, Vagrant has <s>cookies</s> plugins.","","","### Helpers","","","<center>","![vagran up](http://blog.bigpanda.io/wp-content/uploads/2014/05/epicKid1.jpg)"]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":76,"column":0},"end":{"row":77,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":75,"column":0},"end":{"row":76,"column":0}},"nl":"\n","lines":[""]}]}],[{"group":"doc","deltas":[{"action":"removeLines","range":{"start":{"row":74,"column":0},"end":{"row":75,"column":0}},"nl":"\n","lines":[""]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":2,"column":0},"end":{"row":2,"column":86},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1406795486307,"hash":"0042a5267fe2875672a0f9e4419628907e75b83e"}